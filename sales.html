<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>مبيعات اليوم - مخبز العطياني</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #fff8f0;
      padding: 2rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }
    th, td {
      padding: 1rem;
      border: 1px solid #ccc;
      text-align: right;
    }
    button {
      padding: 0.7rem 1.5rem;
      background-color: #c48a47;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2>مبيعات اليوم</h2>

  <table>
    <thead>
      <tr>
        <th>المنتج</th>
        <th>السعر (دينار)</th>
        <th>الكمية</th>
        <th>الإجمالي</th>
      </tr>
    </thead>
    <tbody id="salesTable">
      <!-- يتم توليد المنتجات هنا -->
    </tbody>
  </table>

  <h3>الإجمالي الكلي: <span id="total">0.000</span> دينار</h3>

  <button onclick="saveDay()">حفظ التقرير</button>

  <script>
    const products = [
      { name: "خبز فينو", price: 0.50 },
      { name: "شراك", price: 0.30 },
      { name: "قرشلة", price: 0.40 },
      { name: "خبز رخو", price: 0.25 },
      { name: "خبز لبناني", price: 0.35 },
      { name: "خبز النور", price: 0.45 }
    ];

    function generateTable() {
      const table = document.getElementById("salesTable");
      table.innerHTML = "";
      products.forEach((product, index) => {
        const row = document.createElement("tr");

        row.innerHTML = `
          <td>${product.name}</td>
          <td>${product.price.toFixed(3)}</td>
          <td><input type="number" min="0" value="0" data-index="${index}" onchange="updateTotal()"></td>
          <td id="total-${index}">0.000</td>
        `;

        table.appendChild(row);
      });
    }

    function updateTotal() {
      let total = 0;
      document.querySelectorAll("input[type='number']").forEach(input => {
        const index = input.getAttribute("data-index");
        const quantity = parseInt(input.value) || 0;
        const subtotal = quantity * products[index].price;
        document.getElementById(`total-${index}`).textContent = subtotal.toFixed(3);
        total += subtotal;
      });
      document.getElementById("total").textContent = total.toFixed(3);
    }

   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  async function saveDay() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    let y = 20;
    doc.setFont("Helvetica");
    doc.setFontSize(14);
    doc.text("تقرير مبيعات اليوم - مخبز العطياني", 105, y, { align: "center" });
    y += 10;

    doc.setFontSize(12);
    let total = 0;

    products.forEach((product, index) => {
      const input = document.querySelector(`input[data-index="${index}"]`);
      const qty = parseInt(input.value) || 0;
      const subtotal = qty * product.price;
      total += subtotal;
      if (qty > 0) {
        y += 10;
        doc.text(`المنتج: ${product.name} | السعر: ${product.price.toFixed(3)} | الكمية: ${qty} | المجموع: ${subtotal.toFixed(3)} دينار`, 10, y, { align: "right" });
      }
    });

    y += 15;
    doc.setFontSize(13);
    doc.text(`الإجمالي الكلي: ${total.toFixed(3)} دينار`, 10, y, { align: "right" });
    const date = new Date().toLocaleDateString("ar-EG");
    const details = products
      .map((product, index) => {
        const input = document.querySelector(`input[data-index="${index}"]`);
        const qty = parseInt(input.value) || 0;
        const subtotal = qty * product.price;
        return qty > 0 ? `${product.name} - ${qty} × ${product.price} = ${subtotal.toFixed(3)} دينار` : '';
      })
      .filter(Boolean)
      .join("\\n");

    const saved = JSON.parse(localStorage.getItem("reports") || "[]");
    saved.push({ date, total, details });
    localStorage.setItem("reports", JSON.stringify(saved));

    // حفظ الملف
    doc.save("تقرير-مخبز-العطياني.pdf");
  }
</script>


    window.onload = generateTable;
  </script>
<!-- مكتبة jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</body>
</html>
